<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Document</title>
  <style type="text/css">
  	*{
  		margin: 0;
  		padding: 0;
  	}
  	html{
  		height: 100%;
  	}
  body{
    margin: 0;
    padding: 0;
    height: 100%;
  }
.pubu{
    position: absolute;
    width: 100%;
    height: 100%;
    height: auto;
    /*left: 50%;*/
    /*margin-left: -550px;*/
}
.box{
    /*padding:20px 0 0 20px;*/
    float: left;
    /*margin-left: 20px;*/
}
.box img{
    width: 200px;
    margin: 0 10px;
    /*height: auto;*/
    opacity: 0;
}
  </style>
</head>
<body>
    <div class="pubu">
        <div class="box">
              <img data-original="images/柯南.jpg" src="images/柯南.jpg" alt="">
        </div>
        <div class="box">
              <img data-original="images/工藤有希子.jpg" src="images/工藤有希子.jpg" alt="">
        </div>
        <div class="box">
              <img data-original="images/兰.jpg" alt="" src="images/兰.jpg">
        </div>
        <div class="box">
              <img data-original="images/安室透.jpeg" alt="" src="images/安室透.jpeg">
        </div>
        <div class="box">
              <img data-original="images/赤井秀一.jpg" alt="" src="images/赤井秀一.jpg">
        </div>
        <div class="box">
             <img data-original="images/目暮十三.jpg" alt="" src="images/目暮十三.jpg">
        </div>
        <div class="box">
            <img data-original="images/怪盗基德.jpg" alt="" src="images/怪盗基德.jpg">
        </div>
        <div class="box">
            <img data-original="images/步美.jpg" alt="" src="images/步美.jpg">
        </div>
        <div class="box">
            <img data-original="images/基安蒂.jpg" alt="" src="images/基安蒂.jpg">
        </div>
        <div class="box">
            <img data-original="images/基安蒂.jpg" alt="" src="images/基安蒂.jpg">
        </div>
        <div class="box">
            <img data-original="images/基安蒂.jpg" alt="" src="images/基安蒂.jpg">
        </div>
        <div class="box">
            <img data-original="images/安室透.jpg" alt="" src="images/基安蒂.jpg">
        </div>
        <div class="box">
            <img data-original="images/基安蒂.jpg" alt="" src="images/基安蒂.jpg">
        </div>
         <div class="box">
              <img data-original="images/安室透.jpeg" alt="" src="images/安室透.jpeg">
        </div>
         <div class="box">
              <img data-original="images/安室透.jpeg" alt="" src="images/安室透.jpeg">
        </div>
        <div class="box">
              <img data-original="images/安室透.jpeg" alt="" src="images/安室透.jpeg">
        </div>
         <div class="box">
              <img data-original="images/安室透.jpeg" alt="" src="images/安室透.jpeg">
        </div>
        
      </div>
<script type="text/javascript">
window.addEventListener('load',function(){
	setTimeout(function(){
		var box_item = getEle('box')
		var w = document.documentElement.offsetWidth || document.body.offsetWidth
		var len = parseInt(w/200);
		waterFall(box_item,len);
		window.addEventListener('scroll',function(){
			var seeHeight = document.documentElement.clientHeight || document.body.clientHeight; //可见区域高度  
		  var scrollTop = document.documentElement.scrollTop || document.body.scrollTop; //滚动条距离顶部高度  
			console.log(seeHeight,scrollTop,window.outerHeight);
			setTimeout(function(){
				loadImg(len)
			},200)
		})
	},500)
})
const getEle = name=>{
	return document.getElementsByClassName(name)
}
const loadImg = (len)=>{
	var box_item = getEle('box');
	for( var i = 0;i < box_item.length; i++){
		if(box_item[i].getBoundingClientRect().top < document.documentElement.clientHeight && !box_item[i].isLoad){  //判断图片
			box_item[i].isLoad = true;
			var ocon = document.getElementsByClassName('pubu')[0];
			var obox = document.createElement('div');
			obox.className = 'box';
			ocon.appendChild(obox);
			var img = new Image();
			img.src = 'images/'+'博士.jpg';
			obox.appendChild(img);
			waterFall(box_item,len)
		}
	}
}
const waterFall = (box_item,len)=>{
	var hArr = [];
	console.log(box_item)
	for(let i=0;i<box_item.length;i++){
		if(i<len){
			hArr.push(box_item[i].offsetHeight)
//			box_item[i].children[0].style.opacity = "1"    //使opacity变化在4秒内完成
		}else{
			var minH = Math.min.apply(null,hArr);
			var idx = hArr.indexOf(minH);
			box_item[i].style.position = 'absolute';
			box_item[i].style.top = minH+'px';
			box_item[i].style.left = box_item[idx].offsetLeft+'px';
			hArr[idx] = hArr[idx]+box_item[i].offsetHeight;
			console.log(box_item[i].children)
		}
		box_item[i].children[0].style.cssText = "transition: opacity 1s; opacity: 1;"    //使opacity变化在4秒内完成
	}
}
</script>
</body>
</html>